<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CppBenchmark: sort.cpp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CppBenchmark
   &#160;<span id="projectnumber">1.0.0.0</span>
   </div>
   <div id="projectbrief">C++ Benchmark Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">sort.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<p>Sort algorithms benchmark</p>
<div class="fragment"><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">// Created by Ivan Shynkarenka on 18.07.2015</span></div><div class="line"><span class="comment">//</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="cppbenchmark_8h.html">benchmark/cppbenchmark.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;algorithm&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;queue&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;vector&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keywordtype">int</span> slow_size = 10000;</div><div class="line"><span class="keyword">const</span> <span class="keywordtype">int</span> fast_size = 1000000;</div><div class="line"></div><div class="line"><span class="keyword">class </span>SortFixture : <span class="keyword">public</span> <span class="keyword">virtual</span> <a name="_a0"></a><a class="code" href="class_cpp_benchmark_1_1_fixture.html">CppBenchmark::Fixture</a></div><div class="line">{</div><div class="line"><span class="keyword">protected</span>:</div><div class="line">    std::vector&lt;int&gt; items;</div><div class="line"></div><div class="line">    <span class="keywordtype">void</span> <a name="a1"></a><a class="code" href="class_cpp_benchmark_1_1_fixture.html#a53dc414574cb40710ad95c2266bb607d">Initialize</a>(<a name="_a2"></a><a class="code" href="class_cpp_benchmark_1_1_context.html">CppBenchmark::Context</a>&amp; context)<span class="keyword"> override</span></div><div class="line"><span class="keyword">    </span>{</div><div class="line">        items.resize(context.<a name="a3"></a><a class="code" href="class_cpp_benchmark_1_1_context.html#a40fef89b43336b12fcf0cfcb72900946">x</a>());</div><div class="line">        std::generate(items.begin(), items.end(), rand);</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordtype">void</span> <a name="a4"></a><a class="code" href="class_cpp_benchmark_1_1_fixture.html#a5436824d6a8d00158f634f015b648648">Cleanup</a>(<a class="code" href="class_cpp_benchmark_1_1_context.html">CppBenchmark::Context</a>&amp; context)<span class="keyword"> override</span></div><div class="line"><span class="keyword">    </span>{</div><div class="line">        items.clear();</div><div class="line">    }</div><div class="line">};</div><div class="line"></div><div class="line"><span class="keyword">class </span>SelectionSort : <span class="keyword">public</span> <a name="_a5"></a><a class="code" href="class_cpp_benchmark_1_1_benchmark.html">CppBenchmark::Benchmark</a>, <span class="keyword">public</span> SortFixture</div><div class="line">{</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="keyword">using</span> <a name="a6"></a><a class="code" href="class_cpp_benchmark_1_1_benchmark.html#a5bdcb2beebd19a4f2002108c67071284">Benchmark::Benchmark</a>;</div><div class="line"></div><div class="line"><span class="keyword">protected</span>:</div><div class="line">    <span class="keywordtype">void</span> <a name="a7"></a><a class="code" href="class_cpp_benchmark_1_1_benchmark.html#abdbc6bd6fc8d8b6ab89af58af984242c">Run</a>(<a class="code" href="class_cpp_benchmark_1_1_context.html">CppBenchmark::Context</a>&amp; context)<span class="keyword"> override</span></div><div class="line"><span class="keyword">    </span>{</div><div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; items.size(); ++i)</div><div class="line">        {</div><div class="line">            <span class="comment">// Set the current item as minimal</span></div><div class="line">            <span class="keywordtype">size_t</span> min = i;</div><div class="line"></div><div class="line">            <span class="comment">// Found in rest items another minimal</span></div><div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = i + 1; j &lt; items.size(); ++j)</div><div class="line">            {</div><div class="line">                <span class="keywordflow">if</span> (items[j] &lt; items[min])</div><div class="line">                    min = j;</div><div class="line">            }</div><div class="line"></div><div class="line">            <span class="comment">// Swap the current item with minimal</span></div><div class="line">            std::swap(items[i], items[min]);</div><div class="line">        }</div><div class="line">        context.<a name="a8"></a><a class="code" href="class_cpp_benchmark_1_1_context.html#a7f3b6da52954eb49b791ebce41e53e16">metrics</a>().<a name="a9"></a><a class="code" href="class_cpp_benchmark_1_1_phase_metrics.html#a91dd543cfcffb02cacbbd966d38ac402">AddItems</a>(items.size());</div><div class="line">    }</div><div class="line">};</div><div class="line"></div><div class="line"><span class="keyword">class </span>BubbleSort : <span class="keyword">public</span> <a class="code" href="class_cpp_benchmark_1_1_benchmark.html">CppBenchmark::Benchmark</a>, <span class="keyword">public</span> SortFixture</div><div class="line">{</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="keyword">using</span> <a class="code" href="class_cpp_benchmark_1_1_benchmark.html#a5bdcb2beebd19a4f2002108c67071284">Benchmark::Benchmark</a>;</div><div class="line"></div><div class="line"><span class="keyword">protected</span>:</div><div class="line">    <span class="keywordtype">void</span> <a class="code" href="class_cpp_benchmark_1_1_benchmark.html#abdbc6bd6fc8d8b6ab89af58af984242c">Run</a>(<a class="code" href="class_cpp_benchmark_1_1_context.html">CppBenchmark::Context</a>&amp; context)<span class="keyword"> override</span></div><div class="line"><span class="keyword">    </span>{</div><div class="line">        <span class="comment">// Iterate through all items to get the current bound</span></div><div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; items.size(); ++i)</div><div class="line">        {</div><div class="line">            <span class="comment">// Calculate the current bound</span></div><div class="line">            <span class="keywordtype">size_t</span> bound = items.size() - i;</div><div class="line"></div><div class="line">            <span class="comment">// Starting from the current items and for all next items before the bound...</span></div><div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 1; j &lt; bound; ++j)</div><div class="line">            {</div><div class="line">                <span class="comment">// Swap items to bubble up minimal one to the end</span></div><div class="line">                <span class="keywordflow">if</span> (items[j] &lt; items[j - 1])</div><div class="line">                    std::swap(items[j], items[j - 1]);</div><div class="line">            }</div><div class="line">        }</div><div class="line">        context.<a class="code" href="class_cpp_benchmark_1_1_context.html#a7f3b6da52954eb49b791ebce41e53e16">metrics</a>().<a class="code" href="class_cpp_benchmark_1_1_phase_metrics.html#a91dd543cfcffb02cacbbd966d38ac402">AddItems</a>(items.size());</div><div class="line">    }</div><div class="line">};</div><div class="line"></div><div class="line"><span class="keyword">class </span>ShakerSort : <span class="keyword">public</span> <a class="code" href="class_cpp_benchmark_1_1_benchmark.html">CppBenchmark::Benchmark</a>, <span class="keyword">public</span> SortFixture</div><div class="line">{</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="keyword">using</span> <a class="code" href="class_cpp_benchmark_1_1_benchmark.html#a5bdcb2beebd19a4f2002108c67071284">Benchmark::Benchmark</a>;</div><div class="line"></div><div class="line"><span class="keyword">protected</span>:</div><div class="line">    <span class="keywordtype">void</span> <a class="code" href="class_cpp_benchmark_1_1_benchmark.html#abdbc6bd6fc8d8b6ab89af58af984242c">Run</a>(<a class="code" href="class_cpp_benchmark_1_1_context.html">CppBenchmark::Context</a>&amp; context)<span class="keyword"> override</span></div><div class="line"><span class="keyword">    </span>{</div><div class="line">        <span class="comment">// Start values of left and right bound</span></div><div class="line">        <span class="keywordtype">size_t</span> left = 1;</div><div class="line">        <span class="keywordtype">size_t</span> right = items.size();</div><div class="line"></div><div class="line">        <span class="comment">// While left and right bound not met...</span></div><div class="line">        <span class="keywordflow">while</span> (left &lt; right)</div><div class="line">        {</div><div class="line">            <span class="comment">// Bubble down minimal item to the left bound</span></div><div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = right; i &gt; left; --i)</div><div class="line">            {</div><div class="line">                <span class="keywordflow">if</span> (items[i - 1] &lt; items[i - 1 - 1])</div><div class="line">                    std::swap(items[i - 1], items[i - 1 - 1]);</div><div class="line">            }</div><div class="line"></div><div class="line">            <span class="comment">// Increment left bound</span></div><div class="line">            ++left;</div><div class="line"></div><div class="line">            <span class="comment">// Bubble up maximal item to the right bound</span></div><div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = left; i &lt; right; ++i)</div><div class="line">            {</div><div class="line">                <span class="keywordflow">if</span> (items[i + 1 - 1] &lt; items[i - 1])</div><div class="line">                    std::swap(items[i + 1 - 1], items[i - 1]);</div><div class="line">            }</div><div class="line"></div><div class="line">            <span class="comment">// Decrement right bound</span></div><div class="line">            --right;</div><div class="line">        }</div><div class="line">        context.<a class="code" href="class_cpp_benchmark_1_1_context.html#a7f3b6da52954eb49b791ebce41e53e16">metrics</a>().<a class="code" href="class_cpp_benchmark_1_1_phase_metrics.html#a91dd543cfcffb02cacbbd966d38ac402">AddItems</a>(items.size());</div><div class="line">    }</div><div class="line">};</div><div class="line"></div><div class="line"><span class="keyword">class </span>GnomeSort : <span class="keyword">public</span> <a class="code" href="class_cpp_benchmark_1_1_benchmark.html">CppBenchmark::Benchmark</a>, <span class="keyword">public</span> SortFixture</div><div class="line">{</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="keyword">using</span> <a class="code" href="class_cpp_benchmark_1_1_benchmark.html#a5bdcb2beebd19a4f2002108c67071284">Benchmark::Benchmark</a>;</div><div class="line"></div><div class="line"><span class="keyword">protected</span>:</div><div class="line">    <span class="keywordtype">void</span> <a class="code" href="class_cpp_benchmark_1_1_benchmark.html#abdbc6bd6fc8d8b6ab89af58af984242c">Run</a>(<a class="code" href="class_cpp_benchmark_1_1_context.html">CppBenchmark::Context</a>&amp; context)<span class="keyword"> override</span></div><div class="line"><span class="keyword">    </span>{</div><div class="line">        <span class="comment">// Current index</span></div><div class="line">        <span class="keywordtype">size_t</span> i = 1;</div><div class="line">        <span class="comment">// Jump index</span></div><div class="line">        <span class="keywordtype">size_t</span> j = 2;</div><div class="line"></div><div class="line">        <span class="comment">// For each item...</span></div><div class="line">        <span class="keywordflow">while</span> (i &lt; items.size())</div><div class="line">        {</div><div class="line">            <span class="comment">// If the current item is less then previous...</span></div><div class="line">            <span class="keywordflow">if</span> (items[i] &lt; items[i - 1])</div><div class="line">            {</div><div class="line">                <span class="comment">// Swap items</span></div><div class="line">                std::swap(items[i], items[i - 1]);</div><div class="line">                <span class="comment">// Decrease the current item</span></div><div class="line">                --i;</div><div class="line">                <span class="comment">// If we get the left bound then jump the next unsorted item</span></div><div class="line">                <span class="keywordflow">if</span> (i == 0)</div><div class="line">                {</div><div class="line">                    i = j;</div><div class="line">                    ++j;</div><div class="line">                }</div><div class="line">            }</div><div class="line">            <span class="keywordflow">else</span></div><div class="line">            {</div><div class="line">                <span class="comment">// In other case jump to the next unsorted item</span></div><div class="line">                i = j;</div><div class="line">                ++j;</div><div class="line">            }</div><div class="line">        }</div><div class="line">        context.<a class="code" href="class_cpp_benchmark_1_1_context.html#a7f3b6da52954eb49b791ebce41e53e16">metrics</a>().<a class="code" href="class_cpp_benchmark_1_1_phase_metrics.html#a91dd543cfcffb02cacbbd966d38ac402">AddItems</a>(items.size());</div><div class="line">    }</div><div class="line">};</div><div class="line"></div><div class="line"><span class="keyword">class </span>InsertSort : <span class="keyword">public</span> <a class="code" href="class_cpp_benchmark_1_1_benchmark.html">CppBenchmark::Benchmark</a>, <span class="keyword">public</span> SortFixture</div><div class="line">{</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="keyword">using</span> <a class="code" href="class_cpp_benchmark_1_1_benchmark.html#a5bdcb2beebd19a4f2002108c67071284">Benchmark::Benchmark</a>;</div><div class="line"></div><div class="line"><span class="keyword">protected</span>:</div><div class="line">    <span class="keywordtype">void</span> <a class="code" href="class_cpp_benchmark_1_1_benchmark.html#abdbc6bd6fc8d8b6ab89af58af984242c">Run</a>(<a class="code" href="class_cpp_benchmark_1_1_context.html">CppBenchmark::Context</a>&amp; context)<span class="keyword"> override</span></div><div class="line"><span class="keyword">    </span>{</div><div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 1; i &lt; items.size(); ++i)</div><div class="line">        {</div><div class="line">            <span class="comment">// Take the next item</span></div><div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = i + 1; j &gt; 1; --j)</div><div class="line">            {</div><div class="line">                <span class="comment">// Check the current item with the previous one</span></div><div class="line">                <span class="keywordflow">if</span> (items[j - 1] &lt; items[j - 1 - 1])</div><div class="line">                    std::swap(items[j - 1], items[j - 1 - 1]);</div><div class="line">            }</div><div class="line">        }</div><div class="line">        context.<a class="code" href="class_cpp_benchmark_1_1_context.html#a7f3b6da52954eb49b791ebce41e53e16">metrics</a>().<a class="code" href="class_cpp_benchmark_1_1_phase_metrics.html#a91dd543cfcffb02cacbbd966d38ac402">AddItems</a>(items.size());</div><div class="line">    }</div><div class="line">};</div><div class="line"></div><div class="line"><span class="keyword">class </span>ShellSort : <span class="keyword">public</span> <a class="code" href="class_cpp_benchmark_1_1_benchmark.html">CppBenchmark::Benchmark</a>, <span class="keyword">public</span> SortFixture</div><div class="line">{</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="keyword">using</span> <a class="code" href="class_cpp_benchmark_1_1_benchmark.html#a5bdcb2beebd19a4f2002108c67071284">Benchmark::Benchmark</a>;</div><div class="line"></div><div class="line"><span class="keyword">protected</span>:</div><div class="line">    <span class="keywordtype">void</span> <a class="code" href="class_cpp_benchmark_1_1_benchmark.html#abdbc6bd6fc8d8b6ab89af58af984242c">Run</a>(<a class="code" href="class_cpp_benchmark_1_1_context.html">CppBenchmark::Context</a>&amp; context)<span class="keyword"> override</span></div><div class="line"><span class="keyword">    </span>{</div><div class="line">        <span class="comment">// Calculate initial distance</span></div><div class="line">        <span class="keywordtype">size_t</span> d = 1;</div><div class="line">        <span class="keywordflow">while</span> (d &lt; items.size())</div><div class="line">            d = 3 * d + 1;</div><div class="line"></div><div class="line">        <span class="comment">// While distance is valid</span></div><div class="line">        <span class="keywordflow">while</span> (d &gt; 0)</div><div class="line">        {</div><div class="line">            <span class="comment">// Perform insert sort with the given distance</span></div><div class="line">            ShellSortInternal(items, d);</div><div class="line"></div><div class="line">            <span class="comment">// Decrease distance</span></div><div class="line">            d /= 3;</div><div class="line">        }</div><div class="line">        context.<a class="code" href="class_cpp_benchmark_1_1_context.html#a7f3b6da52954eb49b791ebce41e53e16">metrics</a>().<a class="code" href="class_cpp_benchmark_1_1_phase_metrics.html#a91dd543cfcffb02cacbbd966d38ac402">AddItems</a>(items.size());</div><div class="line">    }</div><div class="line"></div><div class="line"><span class="keyword">private</span>:</div><div class="line">    <span class="keywordtype">void</span> ShellSortInternal(std::vector&lt;int&gt;&amp; subitems, <span class="keywordtype">size_t</span> d)<span class="keyword"> const</span></div><div class="line"><span class="keyword">    </span>{</div><div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = d; i &lt; subitems.size(); ++i)</div><div class="line">        {</div><div class="line">            <span class="comment">// Take the next item</span></div><div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = i + 1; j &gt;= d + 1; j -= d)</div><div class="line">            {</div><div class="line">                <span class="comment">// Check the current item with the previous one</span></div><div class="line">                <span class="keywordflow">if</span> (subitems[j - 1] &lt; subitems[j - d - 1])</div><div class="line">                    std::swap(subitems[j - 1], subitems[j - d - 1]);</div><div class="line">            }</div><div class="line">        }</div><div class="line">    }</div><div class="line">};</div><div class="line"></div><div class="line"><span class="keyword">class </span>MergeSort : <span class="keyword">public</span> <a class="code" href="class_cpp_benchmark_1_1_benchmark.html">CppBenchmark::Benchmark</a>, <span class="keyword">public</span> SortFixture</div><div class="line">{</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="keyword">using</span> <a class="code" href="class_cpp_benchmark_1_1_benchmark.html#a5bdcb2beebd19a4f2002108c67071284">Benchmark::Benchmark</a>;</div><div class="line"></div><div class="line"><span class="keyword">protected</span>:</div><div class="line">    <span class="keywordtype">void</span> <a class="code" href="class_cpp_benchmark_1_1_benchmark.html#abdbc6bd6fc8d8b6ab89af58af984242c">Run</a>(<a class="code" href="class_cpp_benchmark_1_1_context.html">CppBenchmark::Context</a>&amp; context)<span class="keyword"> override</span></div><div class="line"><span class="keyword">    </span>{</div><div class="line">        <span class="comment">// Use temporary array</span></div><div class="line">        std::vector&lt;int&gt; temp(items.size());</div><div class="line"></div><div class="line">        <span class="comment">// Start from the chunk size 1</span></div><div class="line">        <span class="keywordtype">size_t</span> chunk = 1;</div><div class="line">        <span class="comment">// While chunk size less than count of items</span></div><div class="line">        <span class="keywordflow">while</span> (chunk &lt; items.size())</div><div class="line">        {</div><div class="line">            <span class="comment">// Perform merge operation for the current chunks</span></div><div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; items.size(); i += 2 * chunk)</div><div class="line">                MergeSortInternal(temp.data() + i, items.data() + i, i, items.size(), chunk);</div><div class="line">            <span class="comment">// Increase chunk size</span></div><div class="line">            chunk *= 2;</div><div class="line">            <span class="comment">// Swap arrays</span></div><div class="line">            std::swap(temp, items);</div><div class="line">        }</div><div class="line">        context.<a class="code" href="class_cpp_benchmark_1_1_context.html#a7f3b6da52954eb49b791ebce41e53e16">metrics</a>().<a class="code" href="class_cpp_benchmark_1_1_phase_metrics.html#a91dd543cfcffb02cacbbd966d38ac402">AddItems</a>(items.size());</div><div class="line">    }</div><div class="line"></div><div class="line"><span class="keyword">private</span>:</div><div class="line">    <span class="keyword">static</span> <span class="keywordtype">void</span> MergeSortInternal(<span class="keywordtype">int</span>* dst, <span class="keywordtype">int</span>* src, <span class="keywordtype">size_t</span> index, <span class="keywordtype">size_t</span> size, <span class="keywordtype">size_t</span> chunk)</div><div class="line">    {</div><div class="line">        <span class="keywordtype">size_t</span> index1 = 0;</div><div class="line">        <span class="keywordtype">size_t</span> index2 = 0;</div><div class="line"></div><div class="line">        <span class="keywordflow">while</span> ((index1 &lt; chunk) || (index2 &lt; chunk))</div><div class="line">        {</div><div class="line">            <span class="comment">// Check bounds of left chunk</span></div><div class="line">            <span class="keywordflow">if</span> ((index + index1 &gt;= size))</div><div class="line">                index1 = chunk;</div><div class="line">            <span class="comment">// Check bounds of right chunk</span></div><div class="line">            <span class="keywordflow">if</span> ((index + chunk + index2 &gt;= size))</div><div class="line">                index2 = chunk;</div><div class="line"></div><div class="line">            <span class="comment">// Check if we use right or left chunk for merge</span></div><div class="line">            <span class="keywordflow">if</span> ((index2 &lt; chunk) &amp;&amp; ((index1 == chunk) || (src[chunk + index2] &lt; src[index1])))</div><div class="line">            {</div><div class="line">                <span class="comment">// Use right chunk</span></div><div class="line">                *dst++ = src[chunk + index2];</div><div class="line">                ++index2;</div><div class="line">            }</div><div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (index1 &lt; chunk)</div><div class="line">            {</div><div class="line">                <span class="comment">// Use left chunk</span></div><div class="line">                *dst++ = src[index1];</div><div class="line">                ++index1;</div><div class="line">            }</div><div class="line">        }</div><div class="line">    }</div><div class="line">};</div><div class="line"></div><div class="line"><span class="keyword">class </span>QuickSort : <span class="keyword">public</span> <a class="code" href="class_cpp_benchmark_1_1_benchmark.html">CppBenchmark::Benchmark</a>, <span class="keyword">public</span> SortFixture</div><div class="line">{</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="keyword">using</span> <a class="code" href="class_cpp_benchmark_1_1_benchmark.html#a5bdcb2beebd19a4f2002108c67071284">Benchmark::Benchmark</a>;</div><div class="line"></div><div class="line"><span class="keyword">protected</span>:</div><div class="line">    <span class="keywordtype">void</span> <a class="code" href="class_cpp_benchmark_1_1_benchmark.html#abdbc6bd6fc8d8b6ab89af58af984242c">Run</a>(<a class="code" href="class_cpp_benchmark_1_1_context.html">CppBenchmark::Context</a>&amp; context)<span class="keyword"> override</span></div><div class="line"><span class="keyword">    </span>{</div><div class="line">        <span class="keywordflow">if</span> (items.size() &gt; 0)</div><div class="line">            QuickSortInternal(items, 1, items.size());</div><div class="line">        context.<a class="code" href="class_cpp_benchmark_1_1_context.html#a7f3b6da52954eb49b791ebce41e53e16">metrics</a>().<a class="code" href="class_cpp_benchmark_1_1_phase_metrics.html#a91dd543cfcffb02cacbbd966d38ac402">AddItems</a>(items.size());</div><div class="line">    }</div><div class="line"></div><div class="line"><span class="keyword">private</span>:</div><div class="line">    <span class="keyword">static</span> <span class="keywordtype">void</span> QuickSortInternal(std::vector&lt;int&gt;&amp; subitems, <span class="keywordtype">size_t</span> left, <span class="keywordtype">size_t</span> right)</div><div class="line">    {</div><div class="line">        <span class="comment">// Choose the pivot item</span></div><div class="line">        <span class="keywordtype">int</span> pivot = subitems[left + ((right - left) / 2) - 1];</div><div class="line"></div><div class="line">        <span class="keywordtype">size_t</span> l = left;</div><div class="line">        <span class="keywordtype">size_t</span> r = right;</div><div class="line"></div><div class="line">        <span class="keywordflow">while</span> (l &lt;= r)</div><div class="line">        {</div><div class="line">            <span class="comment">// Move left if item is less than pivot</span></div><div class="line">            <span class="keywordflow">while</span> ((l &lt; right) &amp;&amp; (subitems[l - 1] &lt; pivot))</div><div class="line">                l++;</div><div class="line">            <span class="comment">// Move right if item is less than pivot</span></div><div class="line">            <span class="keywordflow">while</span> ((r &gt; left) &amp;&amp; (subitems[r - 1] &gt; pivot))</div><div class="line">                r--;</div><div class="line"></div><div class="line">            <span class="keywordflow">if</span> (l &lt;= r)</div><div class="line">            {</div><div class="line">                <span class="comment">// Swap left and right items</span></div><div class="line">                std::swap(subitems[l - 1], subitems[r - 1]);</div><div class="line"></div><div class="line">                <span class="comment">// Move left and right indexes</span></div><div class="line">                ++l;</div><div class="line">                --r;</div><div class="line">            }</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="comment">// Perform quick sort operation for the left sub items</span></div><div class="line">        <span class="keywordflow">if</span> (left &lt; r)</div><div class="line">            QuickSortInternal(subitems, left, r);</div><div class="line">        <span class="comment">// Perform quick sort operation for the right sub items</span></div><div class="line">        <span class="keywordflow">if</span> (l &lt; right)</div><div class="line">            QuickSortInternal(subitems, l, right);</div><div class="line">    }</div><div class="line">};</div><div class="line"></div><div class="line"><span class="keyword">class </span>QuickSort3 : <span class="keyword">public</span> <a class="code" href="class_cpp_benchmark_1_1_benchmark.html">CppBenchmark::Benchmark</a>, <span class="keyword">public</span> SortFixture</div><div class="line">{</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="keyword">using</span> <a class="code" href="class_cpp_benchmark_1_1_benchmark.html#a5bdcb2beebd19a4f2002108c67071284">Benchmark::Benchmark</a>;</div><div class="line"></div><div class="line"><span class="keyword">protected</span>:</div><div class="line">    <span class="keywordtype">void</span> <a class="code" href="class_cpp_benchmark_1_1_benchmark.html#abdbc6bd6fc8d8b6ab89af58af984242c">Run</a>(<a class="code" href="class_cpp_benchmark_1_1_context.html">CppBenchmark::Context</a>&amp; context)<span class="keyword"> override</span></div><div class="line"><span class="keyword">    </span>{</div><div class="line">        <span class="keywordflow">if</span> (items.size() &gt; 0)</div><div class="line">            QuickSort3Internal(items, 1, items.size());</div><div class="line">        context.<a class="code" href="class_cpp_benchmark_1_1_context.html#a7f3b6da52954eb49b791ebce41e53e16">metrics</a>().<a class="code" href="class_cpp_benchmark_1_1_phase_metrics.html#a91dd543cfcffb02cacbbd966d38ac402">AddItems</a>(items.size());</div><div class="line">    }</div><div class="line"></div><div class="line"><span class="keyword">private</span>:</div><div class="line">    <span class="keyword">static</span> <span class="keywordtype">void</span> QuickSort3Internal(std::vector&lt;int&gt;&amp; subitems, <span class="keywordtype">size_t</span> left, <span class="keywordtype">size_t</span> right)</div><div class="line">    {</div><div class="line">        <span class="comment">// Choose the pivot item</span></div><div class="line">        <span class="keywordtype">int</span> pivot = subitems[left + ((right - left) / 2) - 1];</div><div class="line"></div><div class="line">        <span class="keywordtype">size_t</span> bl = left;</div><div class="line">        <span class="keywordtype">size_t</span> br = right;</div><div class="line"></div><div class="line">        <span class="keywordtype">size_t</span> l = left;</div><div class="line">        <span class="keywordtype">size_t</span> r = right;</div><div class="line"></div><div class="line">        <span class="keywordflow">while</span> (l &lt;= r)</div><div class="line">        {</div><div class="line">            <span class="comment">// Move left if item is less than pivot</span></div><div class="line">            <span class="keywordflow">while</span> ((l &lt; right) &amp;&amp; (subitems[l - 1] &lt; pivot))</div><div class="line">                l++;</div><div class="line">            <span class="comment">// Move right if item is less than pivot</span></div><div class="line">            <span class="keywordflow">while</span> ((r &gt; left) &amp;&amp; (subitems[r - 1] &gt; pivot))</div><div class="line">                r--;</div><div class="line"></div><div class="line">            <span class="keywordflow">if</span> (l &lt;= r)</div><div class="line">            {</div><div class="line">                <span class="comment">// Swap left and right items</span></div><div class="line">                std::swap(subitems[l - 1], subitems[r - 1]);</div><div class="line"></div><div class="line">                <span class="comment">// Move equals to the left</span></div><div class="line">                <span class="keywordflow">if</span> (subitems[l - 1] == pivot)</div><div class="line">                {</div><div class="line">                    std::swap(subitems[bl - 1], subitems[l - 1]);</div><div class="line">                    bl++;</div><div class="line">                }</div><div class="line"></div><div class="line">                <span class="comment">// Move equals to the right</span></div><div class="line">                <span class="keywordflow">if</span> (subitems[r - 1] == pivot)</div><div class="line">                {</div><div class="line">                    std::swap(subitems[br - 1], subitems[r - 1]);</div><div class="line">                    br++;</div><div class="line">                }</div><div class="line"></div><div class="line">                <span class="comment">// Move left and right indexes</span></div><div class="line">                ++l;</div><div class="line">                --r;</div><div class="line">            }</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="comment">// Swap left equals with the lower items</span></div><div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> k = left; (k &lt; bl) &amp;&amp; (r &gt; left); ++k, --r)</div><div class="line">            std::swap(subitems[k - 1], subitems[r - 1]);</div><div class="line">        <span class="comment">// Swap right equals with the upper items</span></div><div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> k = right; (k &gt; br) &amp;&amp; (l &lt; right); --k, ++l)</div><div class="line">            std::swap(subitems[k - 1], subitems[l - 1]);</div><div class="line"></div><div class="line">        <span class="comment">// Perform quick sort operation for the left sub items</span></div><div class="line">        <span class="keywordflow">if</span> (left &lt; r)</div><div class="line">            QuickSort3Internal(subitems, left, r);</div><div class="line">        <span class="comment">// Perform quick sort operation for the right sub items</span></div><div class="line">        <span class="keywordflow">if</span> (l &lt; right)</div><div class="line">            QuickSort3Internal(subitems, l, right);</div><div class="line">    }</div><div class="line">};</div><div class="line"></div><div class="line"><span class="keyword">class </span>RadixSort : <span class="keyword">public</span> <a class="code" href="class_cpp_benchmark_1_1_benchmark.html">CppBenchmark::Benchmark</a>, <span class="keyword">public</span> SortFixture</div><div class="line">{</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="keyword">using</span> <a class="code" href="class_cpp_benchmark_1_1_benchmark.html#a5bdcb2beebd19a4f2002108c67071284">Benchmark::Benchmark</a>;</div><div class="line"></div><div class="line"><span class="keyword">protected</span>:</div><div class="line">    <span class="keywordtype">void</span> <a class="code" href="class_cpp_benchmark_1_1_benchmark.html#abdbc6bd6fc8d8b6ab89af58af984242c">Run</a>(<a class="code" href="class_cpp_benchmark_1_1_context.html">CppBenchmark::Context</a>&amp; context)<span class="keyword"> override</span></div><div class="line"><span class="keyword">    </span>{</div><div class="line">        <span class="comment">// Cache radix queue for all digits</span></div><div class="line">        std::queue&lt;int&gt; radix_queue[10];</div><div class="line"></div><div class="line">        <span class="comment">// Initial radix base</span></div><div class="line">        <span class="keywordtype">size_t</span> n = 1;</div><div class="line"></div><div class="line">        <span class="keywordtype">bool</span> found;</div><div class="line">        <span class="keywordflow">do</span></div><div class="line">        {</div><div class="line">            <span class="comment">// Reset found flag</span></div><div class="line">            found = <span class="keyword">false</span>;</div><div class="line"></div><div class="line">            <span class="comment">// Try to put all items into the radix queue</span></div><div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; items.size(); ++i)</div><div class="line">            {</div><div class="line">                <span class="comment">// Get the base item value</span></div><div class="line">                <span class="keywordtype">size_t</span> base = items[i] / n;</div><div class="line"></div><div class="line">                <span class="comment">// Update found flag</span></div><div class="line">                found |= base &gt; 0;</div><div class="line"></div><div class="line">                <span class="comment">// Get the item index in the radix queue</span></div><div class="line">                <span class="keywordtype">size_t</span> index = base % 10;</div><div class="line"></div><div class="line">                <span class="comment">// Add the item into the radix queue</span></div><div class="line">                radix_queue[index].push(items[i]);</div><div class="line">            }</div><div class="line"></div><div class="line">            <span class="comment">// Back items from the radix list</span></div><div class="line">            <span class="keywordflow">if</span> (found)</div><div class="line">            {</div><div class="line">                <span class="keywordtype">size_t</span> index = 0;</div><div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <span class="keyword">sizeof</span>(radix_queue) / <span class="keyword">sizeof</span>(radix_queue[0]); ++i)</div><div class="line">                {</div><div class="line">                    <span class="comment">// Get all items from the corresponding radix queue</span></div><div class="line">                    <span class="keywordflow">while</span> (!radix_queue[i].empty())</div><div class="line">                    {</div><div class="line">                        items[index++] = radix_queue[i].front();</div><div class="line">                        radix_queue[i].pop();</div><div class="line">                    }</div><div class="line">                }</div><div class="line">            }</div><div class="line"></div><div class="line">            <span class="comment">// Increase the current radix base</span></div><div class="line">            n *= 10;</div><div class="line">        } <span class="keywordflow">while</span> (found);</div><div class="line">        context.<a class="code" href="class_cpp_benchmark_1_1_context.html#a7f3b6da52954eb49b791ebce41e53e16">metrics</a>().<a class="code" href="class_cpp_benchmark_1_1_phase_metrics.html#a91dd543cfcffb02cacbbd966d38ac402">AddItems</a>(items.size());</div><div class="line">    }</div><div class="line">};</div><div class="line"></div><div class="line"><span class="keyword">class </span>StdSort : <span class="keyword">public</span> <a class="code" href="class_cpp_benchmark_1_1_benchmark.html">CppBenchmark::Benchmark</a>, <span class="keyword">public</span> SortFixture</div><div class="line">{</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="keyword">using</span> <a class="code" href="class_cpp_benchmark_1_1_benchmark.html#a5bdcb2beebd19a4f2002108c67071284">Benchmark::Benchmark</a>;</div><div class="line"></div><div class="line"><span class="keyword">protected</span>:</div><div class="line">    <span class="keywordtype">void</span> <a class="code" href="class_cpp_benchmark_1_1_benchmark.html#abdbc6bd6fc8d8b6ab89af58af984242c">Run</a>(<a class="code" href="class_cpp_benchmark_1_1_context.html">CppBenchmark::Context</a>&amp; context)<span class="keyword"> override</span></div><div class="line"><span class="keyword">    </span>{</div><div class="line">        std::sort(items.begin(), items.end());</div><div class="line">        context.<a class="code" href="class_cpp_benchmark_1_1_context.html#a7f3b6da52954eb49b791ebce41e53e16">metrics</a>().<a class="code" href="class_cpp_benchmark_1_1_phase_metrics.html#a91dd543cfcffb02cacbbd966d38ac402">AddItems</a>(items.size());</div><div class="line">    }</div><div class="line">};</div><div class="line"></div><div class="line"><a name="a10"></a><a class="code" href="cppbenchmark_8h.html#a0367deec9b5fa69ebfae9a1cacd25014">BENCHMARK_CLASS</a>(SelectionSort, <span class="stringliteral">&quot;SelectionSort&quot;</span>, Settings().Param(slow_size))</div><div class="line"><a class="code" href="cppbenchmark_8h.html#a0367deec9b5fa69ebfae9a1cacd25014">BENCHMARK_CLASS</a>(BubbleSort, <span class="stringliteral">&quot;BubbleSort&quot;</span>, Settings().Param(slow_size))</div><div class="line"><a class="code" href="cppbenchmark_8h.html#a0367deec9b5fa69ebfae9a1cacd25014">BENCHMARK_CLASS</a>(ShakerSort, <span class="stringliteral">&quot;ShakerSort&quot;</span>, Settings().Param(slow_size))</div><div class="line"><a class="code" href="cppbenchmark_8h.html#a0367deec9b5fa69ebfae9a1cacd25014">BENCHMARK_CLASS</a>(GnomeSort, <span class="stringliteral">&quot;GnomeSort&quot;</span>, Settings().Param(slow_size))</div><div class="line"><a class="code" href="cppbenchmark_8h.html#a0367deec9b5fa69ebfae9a1cacd25014">BENCHMARK_CLASS</a>(InsertSort, <span class="stringliteral">&quot;InsertSort&quot;</span>, Settings().Param(slow_size))</div><div class="line"><a class="code" href="cppbenchmark_8h.html#a0367deec9b5fa69ebfae9a1cacd25014">BENCHMARK_CLASS</a>(ShellSort, <span class="stringliteral">&quot;ShellSort&quot;</span>, Settings().Param(slow_size))</div><div class="line"><a class="code" href="cppbenchmark_8h.html#a0367deec9b5fa69ebfae9a1cacd25014">BENCHMARK_CLASS</a>(MergeSort, <span class="stringliteral">&quot;MergeSort&quot;</span>, Settings().Param(fast_size))</div><div class="line"><a class="code" href="cppbenchmark_8h.html#a0367deec9b5fa69ebfae9a1cacd25014">BENCHMARK_CLASS</a>(QuickSort, <span class="stringliteral">&quot;QuickSort&quot;</span>, Settings().Param(fast_size))</div><div class="line"><a class="code" href="cppbenchmark_8h.html#a0367deec9b5fa69ebfae9a1cacd25014">BENCHMARK_CLASS</a>(QuickSort3, <span class="stringliteral">&quot;QuickSort3&quot;</span>, Settings().Param(fast_size))</div><div class="line"><a class="code" href="cppbenchmark_8h.html#a0367deec9b5fa69ebfae9a1cacd25014">BENCHMARK_CLASS</a>(RadixSort, <span class="stringliteral">&quot;RadixSort&quot;</span>, Settings().Param(fast_size))</div><div class="line"><a class="code" href="cppbenchmark_8h.html#a0367deec9b5fa69ebfae9a1cacd25014">BENCHMARK_CLASS</a>(StdSort, <span class="stringliteral">&quot;std::sort&quot;</span>, Settings().Param(fast_size))</div><div class="line"></div><div class="line"><a name="a11"></a><a class="code" href="cppbenchmark_8h.html#a76a768260eed180721a82b78d1bcfe95">BENCHMARK_MAIN</a>()</div></div><!-- fragment --> </div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
